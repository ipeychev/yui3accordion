<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>

<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>Add/remove items dynamically</title>

<link rel="stylesheet" type="text/css" href="http://yui.yahooapis.com/3.0.0/build/cssfonts/fonts-min.css">

<style type="text/css">
    html, body {
        height:100%;
    }

    .stretch, .fixed {
        position:relative;
        overflow: auto;
        height: 100%;
    }
    
    .auto {
        position:relative;
    }
</style>

<script type="text/javascript" src="http://yui.yahooapis.com/3.0.0/build/yui/yui-min.js"></script>

<script type="text/javascript">

YUI({
    combine: true,
    modules: {
        'accordion-css' : {
            type: 'css',
            fullpath: 'http://github.com/ipeychev/yui3accordion/raw/master/build/accordion/assets/skins/sam/accordion.css'
        },
        'button-css' : {
            type: 'css',
            fullpath: 'http://yui.yahooapis.com/2.8.0r4/build/button/assets/skins/sam/button.css'
        },
        'editor-css' : {
            type: 'css',
            fullpath: 'http://yui.yahooapis.com/2.8.0r4/build/editor/assets/skins/sam/editor.css'
        },
        'accordion': {
            type: 'js',
            fullpath: 'http://github.com/ipeychev/yui3accordion/raw/master/build/accordion/accordion-min.js',
            requires:[ 'accordion-css', "widget-stdmod", "event", "anim-easing","dd-constrain","dd-proxy","dd-drop" ]
        },
        'yde': {
            type: 'js',
            fullpath: 'http://yui.yahooapis.com/2.8.0r4/build/yahoo-dom-event/yahoo-dom-event.js'
        },
        'element': {
            type: 'js',
            fullpath: 'http://yui.yahooapis.com/2.8.0r4/build/element/element-min.js',
            requires: [ 'yde' ]
        },
        'container-core': {
            type: 'js',
            fullpath: 'http://yui.yahooapis.com/2.8.0r4/build/container/container_core-min.js',
            requires: [ 'yde', 'element' ]
        },
        'button': {
            type: 'js',
            fullpath: 'http://yui.yahooapis.com/2.8.0r4/build/button/button-min.js',
            requires: [ 'button-css', 'yde', 'container-core' ]
        },
        'simple-editor': {
            type: 'js',
            fullpath: 'http://yui.yahooapis.com/2.8.0r4/build/editor/simpleeditor-min.js',
            requires: [ 'editor-css', 'yde', 'container-core', 'button' ]
        }
    }
} ).use( 'accordion', 'yde', 'element', 'container-core', 'button', 'simple-editor', function(Y) {
     var _accordion, _btnAdd, _btnRemove, _txtLabel, _editor, _txtPixels,
        _expanded, _alwaysVisisble, _closable, _contentHeight, _contentHeightSettings,
        _btnStretch, _btnAuto, _btnFixed;
    
    _btnAdd = new YAHOO.widget.Button( "additem" );
    _btnRemove = new YAHOO.widget.Button( "removeitems" );
    _txtLabel = Y.get( "#label" );
    _txtPixels = Y.get( "#pixels");

    _editor = new YAHOO.widget.SimpleEditor( 'content', {
        height: '200px',
        width: '422px',
        dompath: false,
        animate: false
    });

    _editor.render();

    _expanded = new YAHOO.widget.Button( "expanded" );
    _alwaysVisisble = new YAHOO.widget.Button( "alwaysvisible" );
    _closable = new YAHOO.widget.Button( "closable" );

    _contentHeightSettings = new YAHOO.widget.ButtonGroup( "contentheight_settings" );

    _btnStretch = _contentHeightSettings.getButton( 0 );
    _btnAuto    = _contentHeightSettings.getButton( 1 );
    _btnFixed   = _contentHeightSettings.getButton( 2 );

    _contentHeightSettings.on( "checkedButtonChange", function(e){
        var _checkedButton = e.newValue;

        if( _checkedButton == _btnFixed ){
            _txtPixels.removeAttribute( "disabled" );
        } else {
            _txtPixels.setAttribute( "disabled", "true" );
        }

    }, this, true );
    
    _btnAdd.on( "click", function(e){
        var _item, _html, _el, _contentHeight, _checkedButton, _class;

        _checkedButton = _contentHeightSettings.get( "checkedButton" );

        if( _checkedButton === _btnStretch  ){
            _contentHeight = {
                method: "stretch"
            };

            _class = "stretch";
        } else if( _checkedButton === _btnAuto  ){
            _contentHeight = {
                method: "auto"
            };

            _class = "auto";
        } else if( _checkedButton === _btnFixed  ){
            _contentHeight = {
                method: "fixed",
                height: parseInt( _txtPixels.get( "value" ), 10 ) || 150
            };

            _class = "fixed";
        } else {
            throw "Internal error. No selected button";
        }

        _item = new Y.AccordionItem( {
            label: _txtLabel.get( "value" ),
            expanded: _expanded.get( "checked" ),
            alwaysVisible: _alwaysVisisble.get( "checked" ),
            closable: _closable.get( "checked" ),
            contentBox: Y.guid(),
            contentHeight: _contentHeight
        } );

        _editor.saveHTML();
        _html = _editor.get('element').value;

        _el = Y.Node.create( '<div>' );
        _el.addClass( _class );
        _el.setContent( _html );

        _item.setStdModContent( Y.WidgetStdMod.BODY, _el, Y.WidgetStdMod.REPLACE );

        _accordion.addItem( _item );
    }, this, true );
    
    _btnRemove.on( "click", function(e){
        var _item, _items, i, _length;

        _items = _accordion.get( "items" );
        
        _length = _items.length;
        
        for( i = _length; i>= 0; i-- ){
            _item = _items[i];
            _accordion.removeItem( _item );
        }
    }, this, true );
    
    _accordion = new Y.Accordion( {
        contentBox: "#acc1",
        useAnimation: true,
        collapseOthersOnExpand: true
    });

    _accordion.render();


    _txtPixels.on( "keypress", function(e){
        var charCode = e.keyCode;

        if( charCode > 31 && (charCode < 48 || charCode > 57) ){
            e.preventDefault();
        }

        return true;
    }, this );
});

</script>

</head>

<body class="yui-skin-sam">
    <div style="position: relative; top: 0px; left: 0px; width: 950px; height: 700px;">
        <div style="position: relative; float: left; top: 20px; left: 20px; width: 450px; height: 500px;">
            <div style="font-weight: bold;">Item label:</div>
            <input id="label" value="Label" type="text"><br><br>

            <div style="font-weight: bold;">Item content:</div>
            <textarea id="content" rows="8" cols="30">Sample content</textarea><br/><br/>

            <input id="expanded" type="checkbox" value="Expanded" checked />
            <input id="closable" type="checkbox" value="Closable" checked />
            <input id="alwaysvisible" type="checkbox" value="Always visible"/>

            <br/><br/>
            <span>Content height:</span>

            <table>
            <tbody>
            <tr>
            <td>
            <div id="contentheight_settings" class="yui-buttongroup">
                <input id="stretch" type="radio" name="contentheight" value="Stretch" checked>
                <input id="auto" type="radio" name="contentheight" value="Auto">
                <input id="fixed" type="radio" name="contentheight" value="Fixed:">
            </div>
            </td>

            <td>
                <input id="pixels" value="150" style="width:50px;" type="text" disabled>pixels<br>
            </td>
            </tr>
            </tbody>
            </table>
            
            <br/><br/>
            <input id="additem" value="Add item"/>
            <input id="removeitems" value="Remove items"/>
        </div>

        <div style="position: relative; float: right; left: 20px; top: 20px; width: 450px; height: 520px;">
            <div id="acc1" style="position: relative; height: 520px; overflow:hidden;"> <!-- IE needs these styles in quirks mode -->
            </div>
        </div>
    </div>
</body>
</html>
